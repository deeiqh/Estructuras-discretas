#include <iostream>
#include <string>
#include "rsa.h"

using namespace std;

int main()
{      
    RSA emisor(12);
    RSA receptor(12);    
    string mensaje;
    
    mensaje = "come here";
    //////////
    /*
    ZZ a,b;
    a =conv<ZZ>("20415455441270941598762817366571351376119642388291883537641984527462619896010698295194314734738351187744604963461239589266660603359484779108359366915791861341173343890473890517744520306437429627427590773438823155532299889256039960917485461555236124639269775449107012539877739497694181827885177632382938020055939138638482329149410858801399640906936905715916467356878398771713450021761638817494920227634353678462038240604973644956192696182624378454118616692953018727585786436246005684093830801826429961180661383393369581096296237607213226972977871427708685632172950815788798978170261016294475576725914785152495313039"); //emisor.generar_aleatorio(1324);
    b = conv<ZZ> ("1601494920813360082911155031113284423096609401612987063256660519270652664749297543322806579166233814273935865012130281174839489931000936566810096617160546550673121621149882698856964285218846408672612251573553861710400630391384038105481205023687047209852037033416407053796648646982774629459821680419263729291348660508290769552519065590574340941095597382527791013975863345893902541607279092029811501841632361539890156241538626039646913810451769818158982385639918252058019698307697445791954883949699318811818070179838777671732602952626727278482779394507689951428036675735361486157700577035664742567860367730999547711961"); //emisor.generar_aleatorio(2049);
    //cout << a << '\n' << b<< '\n';
    cout << emisor.euclides(a,b);
    */
    /*
    ZZ a,b;
    a =conv<ZZ>("160149492081336008291115503111328442309660940161298706325666051927065266474929754332280657916623381427393586501213028117483948993100093656681009661716054655067312162114988269885696428521884640867261225157355386171040063039138403810548120502368704720985203703341640705379664864698277462945982168041926372929134866050829076955251906559057434094109559738252779101397586334589390254160727909202981150184163236153989015624153862603964691381045176981815898238563991825205801969830769744579195488394969931881181807017983877767173260295262672727848277939450768995142803667573536148615770057703566474256786036773099954771196"); //
    b = 2;
    cout << emisor.modulo(a,b);
    */
    emisor.set_p();
    emisor.set_q();
    emisor.set_N();
    emisor.set_e();
    emisor.set_d();
    receptor.set_p();
    receptor.set_q();
    receptor.set_N();
    receptor.set_e();
    receptor.set_d();
    
    string cs;
    cs = emisor.cifrar(receptor, mensaje);
    cout << "\nmensaje " << cs << '\n';
    cerr << "\nempezando descifrado ";
    cout << receptor.descifra_mensaje(cs);
    /////////////
    //cout << receptor.descifra_mensaje(emisor.cifrar(mensaje));

    return 0;
}
